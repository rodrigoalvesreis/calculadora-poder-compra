<div class="container form border rounded p-3">
    <form [formGroup]="form" (ngSubmit)="calcular()">
        <div class="row">
            <!-- Valor -->
            <div class="col-12 col-md-5">
                <div class="input-group mb-1">
                    <span class="input-group-text">R$</span>
                    <input class="form-control text-end" appCurrencyMask formControlName="valor"
                        [placeholder]="getPlaceHolder()"
                        [ngClass]="{'is-invalid': form.get('valor')?.invalid && form.get('valor')?.touched}">
                    <span class="input-group-text"  *ngIf="tipo == 'imovel'">
                        <i class="fa-solid fa-home"></i>
                    </span>
                </div>
                <div class="text-danger small" *ngIf="form.get('valor')?.invalid && form.get('valor')?.touched">
                    <span *ngIf="form.get('valor')?.errors?.['required']">Informe o valor.</span>
                    <span *ngIf="form.get('valor')?.errors?.['min']">O valor mínimo é R$ 100,00.</span>
                </div>
            </div>
            <div *ngIf="tipo =='imovel'" class="col-12  col-md-5">
                <div class="input-group mb-1">
                    <span class="input-group-text">R$</span>
                    <input class="form-control text-end" appCurrencyMask formControlName="valorRenda"
                        placeholder="Informe o valor da Renda"
                        [ngClass]="{'is-invalid': form.get('valorRenda')?.invalid && form.get('valorRenda')?.touched}">
                </div>
                <div class="text-danger small" *ngIf="form.get('valorRenda')?.invalid && form.get('valorRenda')?.touched">
                    <span *ngIf="form.get('valorRenda')?.errors?.['required']">Informe o valor da Renda</span>
                    <span *ngIf="form.get('valorRenda')?.errors?.['min']">O valor mínimo é R$ 100,00.</span>
                </div>
            </div>
            <div class="col-12 col-md-2 text-center text-md-start mb-2 mb-md-0">
                <button type="submit" class="btn btn-primary">
                    <i class="fa-solid fa-calculator"></i> Calcular
                </button>
            </div>
        </div>
    </form>
</div>

<!-- Resultados -->
<div *ngIf="resultado.valorImovel > 0" >
    <div class="container p-3  mt-5 border rounded">

        <div class="row resultado" *ngIf="tipo == 'prestacao'">
            <div class="col-12 col-md text-start">
                <h6>Renda necessária</h6>
            </div>
            <div class="col-12 col-md text-end">
                {{ resultado.rendaNecessaria | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
            </div>
        </div>

        <div class="row resultado">
            <div class="col-12 col-md text-start">
                <h6>Valor do Imóvel</h6>
            </div>
            <div class="col-12 col-md text-end">
                {{ resultado.valorEntrada + resultado.valorFinanciado | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
            </div>
        </div>

        <div class="row resultado">
            <div class="col-12 col-md text-start">
                <h6>Valor da Entrada <a href="#obs1"><i class="fa-regular fa-circle-question text-primary"
                            data-bs-toggle="tooltip" title="Explicação do valor da entrada"></i></a></h6>
            </div>
            <div class="col-12 col-md text-end">
                {{ resultado.valorEntrada | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
            </div>
        </div>

        <div class="row resultado">
            <div class="col-12 col-md text-start">
                <h6>Valor Financiado</h6>
            </div>
            <div class="col-12 col-md text-end">
                {{ resultado.valorFinanciado | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
            </div>
        </div>

        <div class="row resultado">
            <div class="col-12 col-md text-start">
                <h6>
                    Taxa:
                    <a href="#obs2"><i *ngIf="resultado.limitado" class="fa-regular fa-circle-question text-primary"
                            data-bs-toggle="tooltip" title="Explicação da taxa nominal"></i></a>
                </h6>
            </div>
            <div class="col-12 col-md text-end">
                {{ resultado.jurosEfetivo | percent:'1.2-4':'pt-BR' }} a.a
            </div>
        </div>

         <div class="row resultado">
            <div class="col-12 col-md text-start">
                <h6>Sistema de Amortização</h6>
            </div>
            <div class="col-12 col-md text-end">
                {{ resultado.sistema | uppercase}}
            </div>
        </div>
        <div class="row resultado">
            <div class="col-12 col-md text-start">
                <h6>Primeira parcela</h6>
            </div>
            <div class="col-12 col-md text-end">
                {{ resultado.primeiraParcela | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
            </div>
        </div>

        <div class="row resultado">
            <div class="col-12 col-md text-start">
                <h6>Última parcela</h6>
            </div>
            <div class="col-12 col-md text-end">
                {{ resultado.ultimaParcela | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
            </div>
        </div>

        <div class="row resultado">
            <div class="col-12 col-md text-start">
                <h6>ITBI e outras despesas</h6>
            </div>
            <div class="col-12 col-md text-end">
                {{ resultado.outrasDespesas | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
            </div>
        </div>
    </div>


    <!-- Observações -->
    <div class="container pt-5">

        <!-- Observação 1 -->
        <div class="alert alert-info d-flex align-items-center" role="alert" id="obs1">
            <i class="fa-solid fa-circle-question me-2"></i>
            <div class="text-start m-3">O seu FGTS ou o subsídio do PMCMV poderão compor o valor da entrada.</div>
        </div>

        <div *ngIf="resultado.limitado" class="alert alert-info d-flex align-items-center" role="alert" id="obs2">
            <i class="fa-solid fa-circle-question me-2"></i>
            <div class="text-start m-3">O valor do imóvel foi limitado ao máximo possível para a sua renda, a fim de
                manter as taxas mais vantajosas do programa Minha Casa Minha Vida</div>
        </div>

    </div>
</div>